#N canvas 311 22 1092 554 10;
#X obj 887 231 gemwin;
#X msg 887 191 create \, 1;
#X msg 917 211 destroy;
#X obj 887 171 loadbang;
#X obj 638 40 cnv 15 400 80 empty empty empty 20 12 0 14 -204786 -66577
0;
#X text 657 50 This shader is the "3d.parallax" from vade's shader
patches for max/msp. The shader uses a normal map \, which controls
the lighting per pixel (and some fake shadows) according to the normal
map.;
#X obj 28 290 cnv 15 440 80 empty empty empty 20 12 0 14 -204786 -66577
0;
#X obj 28 380 cnv 15 440 120 empty empty empty 20 12 0 14 -204786 -66577
0;
#X obj 487 71 gemhead;
#X obj 557 91 bng 15 250 50 0 empty empty empty 0 -6 0 8 -262144 -1
-1;
#N canvas 167 101 632 570 glsl 0;
#X obj 76 486 glsl_program;
#X obj 139 349 pack 0 0;
#X obj 159 329 t b f;
#X msg 139 369 link \$1 \$2;
#X msg 99 449 print;
#X obj 76 39 inlet;
#X obj 76 269 glsl_fragment;
#X obj 76 149 glsl_vertex;
#X obj 76 506 outlet;
#X obj 126 39 inlet;
#X obj 176 39 inlet;
#X obj 216 39 inlet;
#X obj 146 169 change;
#X obj 159 289 change;
#X obj 189 419 print linking;
#X obj 149 389 t b a a;
#X obj 99 429 delay 0;
#X obj 257 140 cnv 15 300 150 empty empty empty 20 12 0 14 -104052
-66577 0;
#X text 300 185 Inlet 1: GEMlist;
#X text 300 205 Inlet 2: vertex shader commands;
#X text 300 225 Inlet 3: fragment shader commands;
#X text 300 245 Inlet 4: glsl programm commands;
#X text 290 165 Inlets:;
#X connect 0 0 8 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 2 1 1 1;
#X connect 3 0 15 0;
#X connect 4 0 0 0;
#X connect 5 0 7 0;
#X connect 6 0 0 0;
#X connect 6 1 13 0;
#X connect 7 0 6 0;
#X connect 7 1 12 0;
#X connect 9 0 7 0;
#X connect 10 0 6 0;
#X connect 11 0 0 0;
#X connect 12 0 1 0;
#X connect 13 0 2 0;
#X connect 15 0 16 0;
#X connect 15 1 0 0;
#X connect 15 2 14 0;
#X connect 16 0 4 0;
#X restore 487 201 pd glsl;
#X obj 487 441 pix_texture;
#X obj 677 371 pix_texture;
#X msg 697 341 texunit 1;
#X obj 677 151 gemhead 20;
#X msg 547 201 print;
#X msg 299 338 heightScale \$1;
#X obj 299 318 * 0.01;
#X floatatom 737 391 5 0 0 0 - - -;
#X floatatom 546 460 5 0 0 0 - - -;
#X obj 487 471 square 3;
#X msg 507 121 open normal.vert;
#X msg 517 141 open normal.frag;
#X obj 487 261 rotateXYZ 0 45 0;
#N canvas 110 140 353 214 pak4 0;
#X obj 79 45 inlet;
#X obj 129 45 inlet;
#X obj 79 95 pack 0 0 0 0;
#X obj 129 65 t b a;
#X obj 169 45 inlet;
#X obj 169 65 t b a;
#X obj 209 45 inlet;
#X obj 209 65 t b a;
#X obj 79 125 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 8 0;
#X connect 3 0 2 0;
#X connect 3 1 2 1;
#X connect 4 0 5 0;
#X connect 5 0 2 0;
#X connect 5 1 2 2;
#X connect 6 0 7 0;
#X connect 7 0 2 0;
#X connect 7 1 2 3;
#X restore 208 423 pd pak4;
#X obj 208 443 list prepend LightPosition;
#X obj 208 463 route list;
#X msg 497 411 mode 0;
#X msg 697 311 mode 0;
#X text 759 340 make this my second texture unit;
#X text 769 390 textureID on the hardware;
#X obj 687 291 loadbang;
#X text 759 310 texture is a square (not a rectangle);
#X obj 208 394 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-initLightx empty
0 -8 0 10 -4034 -1 -1 4 256;
#X obj 248 394 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-initLighty empty
0 -8 0 10 -4034 -1 -1 4 256;
#X obj 288 394 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-initLightz empty
0 -8 0 10 -4034 -1 -1 4 256;
#X obj 328 394 nbx 3 14 1 1 0 0 empty \$0-initLightw empty 0 -8 0 10
-4034 -1 -1 1 256;
#X text 329 412 (that is always 1...);
#X obj 28 40 cnv 15 440 240 empty empty empty 20 12 0 14 -204786 -66577
0;
#X text 50 52 candle;
#X text 50 72 40w;
#X text 50 92 100w;
#X text 50 112 halogen;
#X text 50 132 Carbon Arc;
#X text 50 152 high noon sun;
#X text 50 172 direct sunlight;
#X text 50 192 overcast sky;
#X text 50 212 clear blue sky;
#X obj 527 171 r \$0-from_init;
#N canvas 175 345 800 413 INIT 0;
#X obj 444 313 outlet;
#X msg 74 253 texture 1;
#X msg 114 213 diffuseColor 1 1 1 1;
#X msg 94 233 ambientColor 1 1 1 1;
#X obj 74 53 loadbang;
#X obj 74 133 delay 100;
#X obj 274 153 unpack 0 0 0 0;
#X obj 274 183 s \$0-initLightx;
#X obj 284 203 s \$0-initLighty;
#X obj 294 223 s \$0-initLightz;
#X obj 304 243 s \$0-initLightw;
#X msg 274 133 4 4 4 1;
#X obj 74 313 s \$0-from_init;
#X obj 424 153 unpack 0 0 0 0;
#X msg 424 133 1 1 1 1;
#X obj 424 183 s \$0-initAmbientr;
#X obj 434 203 s \$0-initAmbientg;
#X obj 444 223 s \$0-initAmbientb;
#X obj 454 243 s \$0-initAmbienta;
#X obj 484 133 r \$0-lightColor;
#X obj 74 73 t b b b b b;
#X msg 184 133 45;
#X obj 184 153 s \$0-rotatey;
#X obj 74 153 t b b b b;
#X msg 124 193 LightPosition 4 4 4 1;
#X connect 1 0 12 0;
#X connect 2 0 12 0;
#X connect 3 0 12 0;
#X connect 4 0 20 0;
#X connect 5 0 23 0;
#X connect 6 0 7 0;
#X connect 6 1 8 0;
#X connect 6 2 9 0;
#X connect 6 3 10 0;
#X connect 11 0 6 0;
#X connect 13 0 15 0;
#X connect 13 1 16 0;
#X connect 13 2 17 0;
#X connect 13 3 18 0;
#X connect 14 0 13 0;
#X connect 19 0 13 0;
#X connect 20 0 5 0;
#X connect 20 1 11 0;
#X connect 20 2 14 0;
#X connect 20 3 0 0;
#X connect 20 4 21 0;
#X connect 21 0 22 0;
#X connect 23 0 1 0;
#X connect 23 1 3 0;
#X connect 23 2 2 0;
#X connect 23 3 24 0;
#X connect 24 0 12 0;
#X restore 557 71 pd INIT;
#X msg 156 51 1 0.576471 0.164706;
#X msg 156 71 1 0.772549 0.560784;
#X msg 156 91 1 0.839216 0.666667;
#X msg 156 111 1 0.945098 0.878431;
#X msg 156 131 1 0.980392 0.956863;
#X msg 156 151 1 1 0.984314;
#X msg 156 171 1 1 1;
#X msg 156 191 0.788235 0.886275 1;
#X msg 156 211 0.25098 0.611765 1;
#N canvas 110 140 357 218 pak4 0;
#X obj 79 45 inlet;
#X obj 129 45 inlet;
#X obj 79 95 pack 0 0 0 0;
#X obj 129 65 t b a;
#X obj 169 45 inlet;
#X obj 169 65 t b a;
#X obj 209 45 inlet;
#X obj 209 65 t b a;
#X obj 79 125 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 8 0;
#X connect 3 0 2 0;
#X connect 3 1 2 1;
#X connect 4 0 5 0;
#X connect 5 0 2 0;
#X connect 5 1 2 2;
#X connect 6 0 7 0;
#X connect 7 0 2 0;
#X connect 7 1 2 3;
#X restore 296 83 pd pak4;
#X obj 296 123 route list;
#X obj 296 103 list prepend ambientColor;
#X obj 296 53 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-initAmbientr empty
0 -8 0 10 -261234 -1 -1 1 256;
#X obj 336 53 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-initAmbientg empty
0 -8 0 10 -4034 -1 -1 1 256;
#X obj 376 53 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-initAmbientb empty
0 -8 0 10 -4160 -1 -1 1 256;
#X obj 416 53 nbx 3 14 1 1 0 0 empty \$0-initAmbienta empty 0 -8 0
10 -228856 -1 -1 1 256;
#X obj 156 253 s \$0-lightColor;
#X obj 299 298 nbx 3 14 -1e+37 1e+37 0 0 empty empty empty 0 -8 0 10
-4034 -1 -1 1 256;
#X obj 518 234 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-rotatex empty 0
-8 0 10 -4034 -1 -1 8 256;
#X obj 558 234 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-rotatey empty 0
-8 0 10 -4034 -1 -1 45 256;
#X obj 598 234 nbx 3 14 -1e+37 1e+37 0 0 empty \$0-rotatez empty 0
-8 0 10 -4034 -1 -1 0 256;
#X obj 497 391 loadbang;
#X text 417 67 (no fx);
#X obj 697 201 cnv 15 15 15 empty empty empty 20 12 0 14 -4034 -66577
0;
#X text 696 180 load alt image;
#X obj 507 311 cnv 15 15 15 empty empty empty 20 12 0 14 -4034 -66577
0;
#X text 506 290 load alt image;
#X obj 487 361 pix_image wall_normal.jpg;
#X msg 527 311 open sculpture_n.tif;
#X msg 717 201 open sculpture.tga;
#X obj 677 251 pix_image wall_color.jpg;
#X msg 717 221 open wall_color.jpg;
#X msg 527 331 open wall_normal.jpg;
#X text 84 308 this works better with the;
#X text 84 328 sculpture image (use low values);
#X connect 1 0 0 0;
#X connect 2 0 0 0;
#X connect 3 0 1 0;
#X connect 8 0 10 0;
#X connect 9 0 21 0;
#X connect 9 0 22 0;
#X connect 10 0 23 0;
#X connect 11 0 20 0;
#X connect 11 1 19 0;
#X connect 12 1 18 0;
#X connect 13 0 12 0;
#X connect 14 0 80 0;
#X connect 15 0 10 3;
#X connect 16 0 10 3;
#X connect 17 0 16 0;
#X connect 21 0 10 1;
#X connect 22 0 10 2;
#X connect 23 0 77 0;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 26 0 10 3;
#X connect 27 0 11 0;
#X connect 28 0 12 0;
#X connect 31 0 28 0;
#X connect 31 0 13 0;
#X connect 33 0 24 0;
#X connect 34 0 24 1;
#X connect 35 0 24 2;
#X connect 36 0 24 3;
#X connect 48 0 10 3;
#X connect 49 0 9 0;
#X connect 50 0 66 0;
#X connect 51 0 66 0;
#X connect 52 0 66 0;
#X connect 53 0 66 0;
#X connect 54 0 66 0;
#X connect 55 0 66 0;
#X connect 56 0 66 0;
#X connect 57 0 66 0;
#X connect 58 0 66 0;
#X connect 59 0 61 0;
#X connect 60 0 10 3;
#X connect 61 0 60 0;
#X connect 62 0 59 0;
#X connect 63 0 59 1;
#X connect 64 0 59 2;
#X connect 65 0 59 3;
#X connect 67 0 17 0;
#X connect 68 0 23 1;
#X connect 69 0 23 2;
#X connect 70 0 23 3;
#X connect 71 0 27 0;
#X connect 77 0 11 0;
#X connect 78 0 77 0;
#X connect 79 0 80 0;
#X connect 80 0 12 0;
#X connect 81 0 80 0;
#X connect 82 0 77 0;
